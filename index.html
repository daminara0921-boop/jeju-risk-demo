<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì œì£¼ ì—°ì•ˆ ìœ„í—˜ ì§€ë„</title>

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f3f4f6;
      display: flex;
      justify-content: center;
      padding: 20px;
      padding-bottom: 130px; /* í•˜ë‹¨ ê³ ì • ë¦¬ì›Œë“œ ë°” ê³µê°„ */
    }

    .container {
      width: 100%;
      max-width: 420px;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .card {
      background: white;
      border-radius: 18px;
      padding: 16px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
    }

    h1 { margin: 0; font-size: 20px; font-weight: 800; }

    .desc {
      margin-top: 8px;
      margin-bottom: 0;
      font-size: 13px;
      color: #4b5563;
      line-height: 1.4;
    }

    /* ===== ì§€ë„ ===== */
    .mapBox {
      position: relative;
      width: 100%;
      aspect-ratio: 4 / 3;
      border-radius: 14px;
      overflow: hidden;
      background: #e5e7eb;
    }
    .mapBox img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    /* ë²”ë¡€: ì˜¤ë¥¸ìª½ ì•„ë˜ */
    .legend {
      position: absolute;
      right: 12px;
      bottom: 12px;
      border-radius: 14px;
      background: rgba(255,255,255,0.9);
      border: 1px solid #e5e7eb;
      padding: 8px 10px;
      font-size: 11px;
      color: #374151;
      backdrop-filter: blur(6px);
    }
    .legend b { display: block; margin-bottom: 4px; }

    /* +10P íŒì—… */
    .toast {
      position: fixed;
      left: 50%;
      top: 14%;
      transform: translateX(-50%);
      background: rgba(17,24,39,0.92);
      color: white;
      padding: 10px 14px;
      border-radius: 999px;
      font-size: 13px;
      font-weight: 900;
      box-shadow: 0 12px 30px rgba(0,0,0,0.25);
      border: 1px solid rgba(255,255,255,0.12);
      z-index: 99999;
      opacity: 0;
      pointer-events: none;
    }
    .toast.show { animation: pop 1.1s ease forwards; }
    @keyframes pop {
      0% { opacity: 0; transform: translateX(-50%) translateY(10px) scale(0.95); }
      15% { opacity: 1; transform: translateX(-50%) translateY(0px) scale(1.03); }
      55% { opacity: 1; transform: translateX(-50%) translateY(-6px) scale(1); }
      100% { opacity: 0; transform: translateX(-50%) translateY(-18px) scale(0.98); }
    }

    /* ë²„íŠ¼ */
    .btn {
      width: 100%;
      border-radius: 14px;
      padding: 14px 12px;
      font-weight: 800;
      font-size: 14px;
      cursor: pointer;
    }
    .btnBlack { background: black; color: white; border: none; }
    .btnWhite { background: white; border: 1px solid #e5e7eb; }

    /* íŒ¨ë„ */
    .panel {
      display: none;
      margin-top: 12px;
      padding: 14px;
      border-radius: 14px;
      background: #f9fafb;
      border: 1px solid #e5e7eb;
    }
    .panelTitle { font-size: 14px; font-weight: 900; margin: 0 0 8px 0; color: #111827; }
    .guide { font-size: 12px; color: #4b5563; margin: 0 0 12px 0; line-height: 1.4; }
    .hint { font-size: 12px; color: #6b7280; margin: 8px 0 0 0; }

    .fileBox { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
    input[type="file"] { font-size: 12px; }

    .uploadBtn {
      padding: 10px 12px;
      border-radius: 12px;
      border: none;
      background: #111827;
      color: white;
      font-weight: 900;
      cursor: pointer;
      font-size: 12px;
    }
    .ghostBtn {
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      background: white;
      font-weight: 900;
      cursor: pointer;
      font-size: 12px;
    }

    .status {
      margin-top: 10px;
      font-size: 12px;
      color: #111827;
      font-weight: 800;
      line-height: 1.4;
      display: none;
    }
    .status small {
      display: block;
      color: #6b7280;
      font-weight: 400;
      margin-top: 2px;
    }

    /* ê²€ìƒ‰ UI */
    .searchRow {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-top: 10px;
      flex-wrap: wrap;
    }
    .searchRow input {
      flex: 1;
      min-width: 180px;
      padding: 11px 12px;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      background: white;
      font-size: 13px;
      outline: none;
    }
    .searchBtn {
      width: 44px;
      height: 44px;
      border-radius: 12px;
      border: none;
      background: #111827;
      color: white;
      font-size: 18px;
      font-weight: 900;
      cursor: pointer;
      display: grid;
      place-items: center;
    }

    /* ìƒ˜í”Œ ì´ë¯¸ì§€ */
    .sampleWrap {
      display: none;
      margin-top: 12px;
      border-radius: 14px;
      overflow: hidden;
      border: 1px solid #e5e7eb;
      background: #111827;
    }
    .sampleHeader {
      padding: 10px 12px;
      background: white;
      border-bottom: 1px solid #e5e7eb;
      font-size: 12px;
      font-weight: 900;
      color: #111827;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .badge {
      font-size: 11px;
      font-weight: 900;
      color: white;
      background: #111827;
      padding: 6px 10px;
      border-radius: 999px;
    }

    .sampleBody {
      position: relative;
      width: 100%;
      aspect-ratio: 4 / 3;
      background: #111827;
    }
    .sampleBody img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    .sampleFallback {
      position: absolute;
      inset: 0;
      display: grid;
      place-items: center;
      color: rgba(255,255,255,0.85);
      font-size: 12px;
      padding: 16px;
      text-align: center;
      line-height: 1.4;
    }

    /* í˜‘ì¬ ê²€ìƒ‰ì‹œì—ë§Œ ë³´ì´ëŠ” ì´¬ì˜ ê¸°ì¤€ ë¬¸êµ¬ */
    .shotHint{
      display: none;
      margin-top: 10px;
      padding: 10px 12px;
      border-radius: 14px;
      background: #fff7ed;
      border: 1px solid #fed7aa;
      color: #9a3412;
      font-size: 12px;
      font-weight: 800;
      line-height: 1.35;
    }
    .shotHint b{ font-weight: 900; }

    /* ì˜ˆì¸¡ */
    .predictBox {
      display: none;
      gap: 8px;
      margin-top: 12px;
      flex-wrap: wrap;
    }
    .pill {
      padding: 8px 10px;
      border-radius: 999px;
      font-size: 12px;
      border: 1px solid #e5e7eb;
      background: white;
      cursor: pointer;
      font-weight: 900;
    }
    .pill.active { background: #111827; color: white; border-color: #111827; }

    .predictText {
      display: none;
      margin-top: 10px;
      font-size: 12px;
      color: #374151;
      line-height: 1.45;
    }

    /* AR */
    .arControls { display: none; margin-top: 12px; gap: 10px; flex-wrap: wrap; }
    .arWrap {
      display: none;
      margin-top: 12px;
      border-radius: 14px;
      overflow: hidden;
      border: 1px solid #e5e7eb;
      background: #111827;
    }
    .arFrame {
      position: relative;
      width: 100%;
      height: min(72vh, 640px);
      background: #111827;
    }
    .arFrame video {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      background: #111827;
    }
    .arHUD {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(17,24,39,0.55);
      color: white;
      padding: 8px 10px;
      border-radius: 12px;
      font-size: 12px;
      line-height: 1.35;
      border: 1px solid rgba(255,255,255,0.15);
      z-index: 10;
    }
    .waterLabel {
      position: absolute;
      right: 10px;
      transform: translateY(-50%);
      background: rgba(239,68,68,0.92);
      color: white;
      padding: 6px 8px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 900;
      border: 1px solid rgba(255,255,255,0.2);
      z-index: 11;
      white-space: nowrap;
    }

    /* â€˜ã„´ì+ë¼ìš´ë“œâ€™ ê¸°ì¤€ ë¼ì¸ */
    .baseCurve{
      position: absolute;
      left: 10px;
      right: 10px;
      height: 70px;
      top: 78%;
      transform: translateY(-50%);
      z-index: 9;
      pointer-events: none;
    }
    .baseCurve path{
      fill: none;
      stroke: rgba(59,130,246,0.95);
      stroke-width: 14;
      stroke-linecap: round;
      stroke-linejoin: round;
    }

    .baseNote {
      margin-top: 10px;
      padding: 10px 12px;
      border-radius: 14px;
      background: #eff6ff;
      border: 1px solid #bfdbfe;
      color: #1e3a8a;
      font-size: 12px;
      font-weight: 900;
      line-height: 1.35;
    }

    /* ===== í•˜ë‹¨ ê³ ì • ë¦¬ì›Œë“œ ===== */
    .rewardDock {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      padding: 10px 12px;
      z-index: 9999;
    }
    .dockInner {
      max-width: 420px;
      margin: 0 auto;
      background: rgba(255,255,255,0.96);
      border: 1px solid #e5e7eb;
      border-radius: 18px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.12);
      padding: 12px 14px;
      backdrop-filter: blur(8px);
      cursor: pointer; /* âœ… í´ë¦­ ê°€ëŠ¥ */
      user-select: none;
    }
    .dockTop { display: flex; justify-content: space-between; align-items: center; }
    .dockTitle { font-size: 13px; font-weight: 900; color: #111827; }
    .dockPoint { font-size: 13px; font-weight: 900; color: #111827; }
    .dockBarTrack {
      margin-top: 8px;
      width: 100%;
      height: 12px;
      background: #e5e7eb;
      border-radius: 999px;
      overflow: hidden;
    }
    .dockBarFill {
      height: 100%;
      width: 0%;
      background: #111827;
      border-radius: 999px;
      transition: width 0.35s ease;
    }
    .dockBottom {
      margin-top: 8px;
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      color: #4b5563;
    }
    .dockBottom b { color: #111827; }

    .locLabel {
      display: none;
      margin-top: 10px;
      padding: 10px 12px;
      border-radius: 14px;
      background: white;
      border: 1px solid #e5e7eb;
      font-size: 12px;
      color: #111827;
      font-weight: 900;
      justify-content: space-between;
      align-items: center;
    }

    /* ====== í™ˆì— ë“¤ì–´ê°ˆ 'ë‚´ íŒ¨ìŠ¤í¬íŠ¸' ì¹´ë“œ(í´ë¦­) ====== */
    .passportHomeCard{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      cursor:pointer;
      user-select:none;
    }
    .passportLeft{
      display:flex;
      gap:12px;
      align-items:center;
      min-width: 0;
    }
    .passportIcon{
      width: 44px;
      height: 44px;
      border-radius: 14px;
      background:#f3f4f6;
      display:grid;
      place-items:center;
      font-size: 22px;
      flex: 0 0 auto;
    }
    .passportText{
      min-width: 0;
    }
    .passportTitle{
      font-size: 14px;
      font-weight: 900;
      color:#111827;
      margin: 0;
    }
    .passportSub{
      font-size: 12px;
      color:#6b7280;
      margin-top: 4px;
      line-height: 1.35;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 260px;
    }
    .chev{
      width: 36px;
      height: 36px;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      background:#fff;
      display:grid;
      place-items:center;
      font-weight: 900;
      color:#111827;
      flex: 0 0 auto;
    }

    /* ====== ëª¨ë‹¬(ë¦¬ì›Œë“œ/íŒ¨ìŠ¤í¬íŠ¸) ====== */
    .modal {
      position: fixed;
      inset: 0;
      background: rgba(17,24,39,0.55);
      z-index: 100000;
      display: none;
      padding: 14px;
    }
    .modal.show { display: grid; place-items: center; }
    .modalSheet {
      width: 100%;
      max-width: 420px;
      height: min(92vh, 860px);
      background: #f4f5f7;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 18px 60px rgba(0,0,0,0.35);
      border: 1px solid rgba(255,255,255,0.18);
      display: flex;
      flex-direction: column;
    }
    .modalTopBar{
      background: #fff;
      padding: 14px 14px;
      border-bottom: 1px solid #e5e7eb;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
    }
    .modalTopTitle{
      font-size: 15px;
      font-weight: 900;
      color:#111827;
    }
    .closeBtn{
      width: 40px;
      height: 40px;
      border-radius: 14px;
      border: 1px solid #e5e7eb;
      background: #fff;
      font-weight: 900;
      cursor:pointer;
    }
    .modalScroll{
      overflow: auto;
      padding-bottom: 16px;
    }

    /* ====== ì‹œì•ˆ ê¸°ë°˜ ë¦¬ì›Œë“œ/íŒ¨ìŠ¤í¬íŠ¸ ì»´í¬ë„ŒíŠ¸(ëª¨ë‹¬ ì•ˆ) ====== */
    .page-header {
      background: white;
      padding: 18px 16px;
      border-bottom: 1px solid #e8e8e8;
    }
    .page-title {
      font-size: 20px;
      font-weight: 900;
      color: #1a1a1a;
      margin-bottom: 6px;
    }
    .page-subtitle {
      font-size: 13px;
      color: #666;
      line-height: 1.45;
    }

    .points-card, .level-card {
      background: white;
      margin: 12px;
      border-radius: 16px;
      padding: 26px 16px;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }
    .points-display {
      font-size: 46px;
      font-weight: 900;
      color: #111827;
      margin-bottom: 6px;
      letter-spacing: -1px;
    }
    .points-label {
      font-size: 13px;
      color: #666;
    }

    .section-label {
      font-size: 12px;
      color: #999;
      margin: 10px 0 10px 0;
      font-weight: 700;
      padding: 0 16px;
    }

    .benefits-list { padding: 0 12px 6px 12px; }
    .benefit-item {
      background: white;
      border-radius: 12px;
      padding: 14px;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }
    .benefit-emoji {
      font-size: 24px;
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f8f9fa;
      border-radius: 12px;
      flex-shrink: 0;
    }
    .benefit-content { flex: 1; min-width: 0; }
    .benefit-name {
      font-size: 14px;
      font-weight: 900;
      color: #111827;
      margin-bottom: 4px;
    }
    .benefit-detail {
      font-size: 12px;
      color: #888;
      line-height: 1.3;
    }
    .benefit-button {
      background: #111827;
      color: white;
      border: none;
      padding: 10px 14px;
      border-radius: 10px;
      font-size: 12px;
      font-weight: 900;
      cursor: pointer;
      white-space: nowrap;
    }

    .rewards-footer, .progress-card {
      background: white;
      margin: 12px;
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }

    .next-reward {
      font-size: 13px;
      color: #666;
      margin-bottom: 12px;
      text-align: center;
      line-height: 1.35;
    }
    .next-reward strong { color: #111827; font-weight: 900; }

    .action-button {
      background: #111827;
      color: white;
      border: none;
      padding: 14px;
      border-radius: 14px;
      font-size: 14px;
      font-weight: 900;
      cursor: pointer;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    /* passport (modal) */
    .level-icon {
      width: 68px;
      height: 68px;
      background: #f8f9fa;
      border-radius: 50%;
      margin: 0 auto 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 34px;
    }
    .level-text {
      font-size: 18px;
      font-weight: 900;
      color: #111827;
      margin-bottom: 6px;
    }
    .level-desc {
      font-size: 12px;
      color: #888;
      line-height: 1.35;
    }

    .content-section {
      background: white;
      margin: 12px;
      border-radius: 16px;
      padding: 14px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }
    .stats-grid { display: grid; gap: 10px; }
    .stat-box {
      background: white;
      border-radius: 12px;
      padding: 14px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border: 1px solid #eef0f3;
    }
    .stat-name { font-size: 13px; color: #666; font-weight: 700; }
    .stat-number { font-size: 20px; font-weight: 900; color: #111827; }

    .progress-label {
      font-size: 13px;
      color: #111827;
      margin-bottom: 10px;
      font-weight: 900;
      text-align: left;
    }
    .progress-track {
      background: #e8e8e8;
      height: 10px;
      border-radius: 6px;
      overflow: hidden;
      margin-bottom: 10px;
    }
    .progress-bar-fill {
      background: #111827;
      height: 100%;
      width: 0%;
      border-radius: 6px;
      transition: width .35s ease;
    }
    .progress-info {
      font-size: 12px;
      color: #888;
      text-align: center;
      line-height: 1.35;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="card">
      <h1 id="appTitle">ì œì£¼ ì—°ì•ˆ ìœ„í—˜ ì§€ë„</h1>
      <p class="desc">
        <b>ìš°ë¦¬ ëª¨ë‘ í•¨ê»˜ ë§Œë“œëŠ” ì•ˆì „ ëª¨ë‹ˆí„°ë§</b><br />
        ì‘ì€ í–‰ë™ì´ ì œì£¼ë„ë¥¼ ì§€í‚µë‹ˆë‹¤. í•¨ê»˜í•˜ê³  ë³´ìƒ ë°›ì•„ìš”!
      </p>
    </div>

    <!-- âœ… í™ˆ: ë‚´ íŒ¨ìŠ¤í¬íŠ¸ ì¹´ë“œ (ì œëª©ê³¼ ì§€ë„ ì‚¬ì´) -->
    <div id="passportHome" class="card passportHomeCard" role="button" aria-label="ë‚´ íŒ¨ìŠ¤í¬íŠ¸ ì—´ê¸°">
      <div class="passportLeft">
        <div class="passportIcon">ğŸªª</div>
        <div class="passportText">
          <p class="passportTitle">ë‚´ íŒ¨ìŠ¤í¬íŠ¸</p>
          <div id="passportHomeSub" class="passportSub">ì°¸ì—¬ ê¸°ë¡ê³¼ ë ˆë²¨ì„ í™•ì¸í•´ìš”</div>
        </div>
      </div>
      <div class="chev">â€º</div>
    </div>

    <div class="card">
      <div class="mapBox">
        <img src="jeju-risk-map.png" alt="Jeju Risk Map" />
        <div class="legend">
          <b>ìœ„í—˜ ë“±ê¸‰</b>
          ğŸŸ¢ ë³´í†µ&nbsp;&nbsp; ğŸŸ£ ìš°ë ¤&nbsp;&nbsp; ğŸ”´ ì‹¬ê°
        </div>
      </div>
    </div>

    <div class="card">
      <button id="btnUpload" class="btn btnBlack">ğŸ“¸ ì‚¬ì§„ ì œë³´í•˜ê¸°</button>

      <div id="uploadPanel" class="panel">
        <p class="panelTitle">ì‚¬ì§„ ì œë³´</p>
        <p class="guide">
          ë¨¼ì € <b>í˜„ì¬ ìœ„ì¹˜</b>ë¥¼ ì…ë ¥í•˜ê³  ë‹ë³´ê¸°ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”.<br />
          ê·¸ëŸ¬ë©´ ê¶Œì¥ ì´¬ì˜ ê°ë„ ìƒ˜í”Œì„ ë³´ì—¬ì¤„ê²Œìš”.
        </p>

        <div class="searchRow">
          <input id="uploadLocInput" placeholder="í˜„ì¬ ìœ„ì¹˜ ì…ë ¥ (ì˜ˆ: í˜‘ì¬)" />
          <button id="uploadLocSearch" class="searchBtn" title="ê²€ìƒ‰">ğŸ”</button>
        </div>

        <div id="uploadLocStatus" class="status"></div>

        <div id="sampleWrap" class="sampleWrap">
          <div class="sampleHeader">
            <span>ê¶Œì¥ ì´¬ì˜ ê°ë„ ìƒ˜í”Œ</span>
            <span class="badge">í˜‘ì¬(ì‹œì•ˆ)</span>
          </div>

          <div class="sampleBody">
            <img id="sampleImg" src="sample-hyeopjae.jpg" alt="ìƒ˜í”Œ ì‚¬ì§„" />
            <div id="sampleFallback" class="sampleFallback">
              ìƒ˜í”Œ ì‚¬ì§„ íŒŒì¼ì„ ì•„ì§ ë„£ì§€ ì•Šì•˜ì–´ìš”.<br/><br/>
              í´ë”ì— <b>sample-hyeopjae.jpg</b>ë¥¼ ë„£ìœ¼ë©´<br/>
              ì´ ì˜ì—­ì— ìë™ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤.
            </div>
          </div>
        </div>

        <div id="shotHint" class="shotHint">
          ğŸ“Œ <b>ëŒ ì¥ì‹ì´ í™”ë©´ ì™¼ìª½ ì•„ë˜</b>ì— ìœ„ì¹˜í•˜ë„ë¡ ì´¬ì˜í•´ì£¼ì„¸ìš”.
        </div>

        <p class="guide" style="margin-top:12px;">
          ìƒ˜í”Œì„ í™•ì¸í•œ ë’¤, ì‚¬ì§„ì„ ì„ íƒí•˜ê³  ì—…ë¡œë“œí•˜ë©´ <b>+10P</b>ê°€ ì ë¦½ë©ë‹ˆë‹¤.
        </p>

        <div class="fileBox">
          <input id="fileInput" type="file" accept="image/*" />
          <button id="submitUpload" class="uploadBtn">ì—…ë¡œë“œ(+10P)</button>
        </div>

        <div id="uploadStatus" class="status"></div>
      </div>

      <div style="height:10px;"></div>

      <button id="btnPredict" class="btn btnWhite">ğŸ”® ë¯¸ë˜ ì˜ˆì¸¡ ë³´ê¸° (AR)</button>

      <div id="predictPanel" class="panel">
        <p class="panelTitle">ë¯¸ë˜ ì˜ˆì¸¡(AR ì‹œì•ˆ)</p>
        <p class="guide">
          í˜„ì¬ ìœ„ì¹˜ë¥¼ ì…ë ¥í•˜ê³  ë‹ë³´ê¸°ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”.<br />
          (ì§€ê¸ˆì€ <b>í˜‘ì¬</b>ë§Œ ì‹œì•ˆìœ¼ë¡œ ì—°ê²°ë˜ì–´ ìˆì–´ìš”)
        </p>

        <div class="searchRow">
          <input id="predictLocInput" placeholder="í˜„ì¬ ìœ„ì¹˜ ì…ë ¥ (ì˜ˆ: í˜‘ì¬)" />
          <button id="predictLocSearch" class="searchBtn" title="ê²€ìƒ‰">ğŸ”</button>
        </div>

        <div id="predictLocStatus" class="status"></div>

        <div id="locLabel" class="locLabel">
          <span>í˜„ì¬ ìœ„ì¹˜: <b id="locName">í˜‘ì¬</b> (ì‹œì•ˆ)</span>
          <span class="badge">ON</span>
        </div>

        <div id="predictBox" class="predictBox">
          <button id="p5" class="pill active">5ë…„ ë’¤</button>
          <button id="p10" class="pill">10ë…„ ë’¤</button>
        </div>

        <div id="predictText" class="predictText"></div>

        <div id="arControls" class="arControls">
          <button id="startAR" class="uploadBtn">ğŸ“· AR ëª¨ë“œ ì‹œì‘</button>
          <button id="stopAR" class="ghostBtn" style="display:none;">ì¢…ë£Œ</button>
        </div>

        <div id="arStage" class="arWrap">
          <div class="arFrame">
            <video id="arVideo" autoplay playsinline></video>

            <!-- ë¹¨ê°„ ì˜ˆìƒ ìˆ˜ìœ„ì„  -->
            <div id="waterLine" style="
              position:absolute; left:0; right:0;
              height:3px; background:#ef4444;
              top:62%;
              box-shadow: 0 0 0 2px rgba(239,68,68,0.25);
              z-index: 6;
            "></div>

            <div id="waterFill" style="
              position:absolute; left:0; right:0; bottom:0;
              top:62%;
              background: rgba(239,68,68,0.25);
              z-index: 5;
            "></div>

            <!-- íŒŒë€ ê¸°ì¤€ ë¼ì¸ -->
            <svg id="baseCurve" class="baseCurve" viewBox="0 0 200 80" preserveAspectRatio="none" aria-hidden="true">
              <path d="M10,20
                       Q40,20 55,40
                       L70,60
                       L190,60" />
            </svg>

            <div class="arHUD">
              <b>í˜‘ì¬ AR ì‹œì•ˆ</b><br/>
              ë¹¨ê°„ ì„  = ì˜ˆìƒ ìˆ˜ìœ„<br/>
              íŒŒë€ ì„  = ê¸°ì¤€(ëŒë¶€ë¦¬)
            </div>

            <div id="waterLabel" class="waterLabel" style="top:62%;">ì˜ˆìƒ ìˆ˜ìœ„ 0.5m</div>
          </div>

          <div class="baseNote">
            ğŸ“Œ <b>ëŒë¶€ë¦¬ì— ë§ì¶°</b> ì¸¡ì • ë¶€íƒë“œë¦½ë‹ˆë‹¤.
          </div>
        </div>

        <p class="hint">* ë°ëª¨ ë²„ì „: ìˆ˜ì¹˜/ë²”ìœ„ëŠ” ë°œí‘œìš© ì‹œë‚˜ë¦¬ì˜¤ ê°’ì…ë‹ˆë‹¤.</p>
      </div>

      <p class="hint">* ì‹¤ë‚´ QR ì‹œì—°ìš©: ì¹´ë©”ë¼ í™”ë©´ ìœ„ì— ìˆ˜ìœ„ ì˜¤ë²„ë ˆì´ë¡œ í‘œí˜„ë©ë‹ˆë‹¤.</p>
    </div>
  </div>

  <div id="toast" class="toast">+10P</div>

  <!-- ===== í•˜ë‹¨ ê³ ì • ë¦¬ì›Œë“œ (í´ë¦­ ì‹œ ëª¨ë‹¬ ì—´ë¦¼) ===== -->
  <div class="rewardDock">
    <div id="rewardDockBtn" class="dockInner" role="button" aria-label="ë‚´ ë¦¬ì›Œë“œ ì—´ê¸°">
      <div class="dockTop">
        <div class="dockTitle">âš¡ ë‚´ ë¦¬ì›Œë“œ</div>
        <div class="dockPoint"><span id="mePointDock">0</span>P</div>
      </div>

      <div class="dockBarTrack">
        <div id="barFillDock" class="dockBarFill"></div>
      </div>

      <div class="dockBottom">
        <span>ë‹¤ìŒ ë¦¬ì›Œë“œê¹Œì§€ <b id="toNextDock">100</b>P</span>
        <span>ì—…ë¡œë“œ <b id="uploadCountDock">0</b>íšŒ</span>
      </div>
    </div>
  </div>

  <!-- ===================== ëª¨ë‹¬: ë‚´ ë¦¬ì›Œë“œ ===================== -->
  <div id="rewardModal" class="modal" aria-hidden="true">
    <div class="modalSheet">
      <div class="modalTopBar">
        <div class="modalTopTitle">ë‚´ ë¦¬ì›Œë“œ</div>
        <button id="closeReward" class="closeBtn" aria-label="ë‹«ê¸°">âœ•</button>
      </div>

      <div class="modalScroll">
        <div class="page-header">
          <div class="page-title">ë‚´ ë¦¬ì›Œë“œ</div>
          <div class="page-subtitle">í•´ì•ˆ ì•ˆì „ ì°¸ì—¬ë¡œ ì ë¦½ëœ í˜œíƒì„<br/>í™•ì¸í•˜ê³  ì‚¬ìš©í•˜ì„¸ìš”</div>
        </div>

        <div class="points-card">
          <div id="rewardPointBig" class="points-display">0P</div>
          <div class="points-label">ì‚¬ìš© ê°€ëŠ¥ í¬ì¸íŠ¸</div>
        </div>

        <div class="section-label">ì‚¬ìš© ê°€ëŠ¥í•œ í˜œíƒ</div>

        <div class="benefits-list">
          <div class="benefit-item">
            <div class="benefit-emoji">ğŸª™</div>
            <div class="benefit-content">
              <div class="benefit-name">íƒë‚˜ëŠ”ì „ ì „í™˜</div>
              <div class="benefit-detail">1,000P â†’ 1,000ì›</div>
            </div>
            <button class="benefit-button" onclick="alert('ë°ëª¨ í™”ë©´ì…ë‹ˆë‹¤ ğŸ™‚')">ì‚¬ìš©</button>
          </div>

          <div class="benefit-item">
            <div class="benefit-emoji">â˜•</div>
            <div class="benefit-content">
              <div class="benefit-name">ê·¼ì²˜ ì¹´í˜ í• ì¸</div>
              <div class="benefit-detail">í•´ì•ˆ ì¸ì¦ ì‹œ 10% í• ì¸</div>
            </div>
            <button class="benefit-button" onclick="alert('ë°ëª¨ í™”ë©´ì…ë‹ˆë‹¤ ğŸ™‚')">ì‚¬ìš©</button>
          </div>

          <div class="benefit-item">
            <div class="benefit-emoji">ğŸŸ</div>
            <div class="benefit-content">
              <div class="benefit-name">ê´€ê´‘ í”„ë¡œê·¸ë¨</div>
              <div class="benefit-detail">í•´ì•ˆ ì²´í—˜ ë¬´ë£Œ ì°¸ì—¬ê¶Œ</div>
            </div>
            <button class="benefit-button" onclick="alert('ë°ëª¨ í™”ë©´ì…ë‹ˆë‹¤ ğŸ™‚')">ì‚¬ìš©</button>
          </div>
        </div>

        <div class="rewards-footer">
          <div class="next-reward">ë‹¤ìŒ ë¦¬ì›Œë“œê¹Œì§€ <strong id="rewardLeftBig">0P</strong> ë‚¨ì•˜ì–´ìš”</div>
          <button id="goARFromReward" class="action-button">
            <span>ğŸ“¸</span>
            <span>ë¯¸ë˜ ì˜ˆì¸¡ ë³´ê¸° (AR)</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- ===================== ëª¨ë‹¬: ë‚´ íŒ¨ìŠ¤í¬íŠ¸ ===================== -->
  <div id="passportModal" class="modal" aria-hidden="true">
    <div class="modalSheet">
      <div class="modalTopBar">
        <div class="modalTopTitle">ë‚´ íŒ¨ìŠ¤í¬íŠ¸</div>
        <button id="closePassport" class="closeBtn" aria-label="ë‹«ê¸°">âœ•</button>
      </div>

      <div class="modalScroll">
        <div class="page-header">
          <div class="page-title">ë‚´ íŒ¨ìŠ¤í¬íŠ¸</div>
          <div class="page-subtitle">í•´ì•ˆ ì•ˆì „ì„ í•¨ê»˜ ì§€ì¼œì˜¨<br/>ë‚˜ì˜ ì°¸ì—¬ ê¸°ë¡ì…ë‹ˆë‹¤</div>
        </div>

        <div class="level-card">
          <div class="level-icon">ğŸ–ï¸</div>
          <div id="passportLevelText" class="level-text">Lv.1 í•´ì•ˆ ìƒˆì‹¹</div>
          <div id="passportLevelDesc" class="level-desc">ê¾¸ì¤€í•œ ì°¸ì—¬ë¡œ ì•ˆì „í•œ í•´ì•ˆì„ ë§Œë“¤ì–´ê°€ê³  ìˆì–´ìš”</div>
        </div>

        <div class="section-label">ëˆ„ì  ì°¸ì—¬ ê¸°ë¡</div>

        <div class="content-section">
          <div class="stats-grid">
            <div class="stat-box">
              <div class="stat-name">ë°©ë¬¸í•œ í•´ì•ˆ</div>
              <div id="statVisited" class="stat-number">0ê³³</div>
            </div>
            <div class="stat-box">
              <div class="stat-name">ì°¸ì—¬í•œ ì¸ì¦</div>
              <div id="statUploads" class="stat-number">0íšŒ</div>
            </div>
            <div class="stat-box">
              <div class="stat-name">ëˆ„ì  ì°¸ì—¬ ì¼ìˆ˜</div>
              <div id="statDays" class="stat-number">0ì¼</div>
            </div>
          </div>
        </div>

        <div class="progress-card">
          <div class="progress-label">ë‹¤ìŒ ë ˆë²¨ê¹Œì§€</div>
          <div class="progress-track">
            <div id="passportProgressFill" class="progress-bar-fill"></div>
          </div>
          <div id="passportProgressInfo" class="progress-info">0íšŒ ì°¸ì—¬ ë” í•„ìš” (0% ë‹¬ì„±)</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ====== ë¦¬ì›Œë“œ ======
    const MAX_POINT = 100;
    const savedPoint = Number(localStorage.getItem("myPoint") || "0");
    const savedCount = Number(localStorage.getItem("myUploadCount") || "0");

    let myPoint = savedPoint;
    let uploadCount = savedCount;

    const toast = document.getElementById("toast");
    const mePointDock = document.getElementById("mePointDock");
    const uploadCountDock = document.getElementById("uploadCountDock");
    const toNextDock = document.getElementById("toNextDock");
    const barFillDock = document.getElementById("barFillDock");

    function showToast(text) {
      toast.textContent = text;
      toast.classList.remove("show");
      void toast.offsetWidth;
      toast.classList.add("show");
    }

    function updateRewardUI() {
      const percent = Math.min(100, (myPoint / MAX_POINT) * 100);
      const left = Math.max(0, MAX_POINT - myPoint);

      mePointDock.textContent = myPoint;
      uploadCountDock.textContent = uploadCount;
      toNextDock.textContent = left;
      barFillDock.style.width = percent + "%";

      localStorage.setItem("myPoint", String(myPoint));
      localStorage.setItem("myUploadCount", String(uploadCount));

      // ëª¨ë‹¬ì—ë„ ë°˜ì˜
      const big = document.getElementById("rewardPointBig");
      const leftBig = document.getElementById("rewardLeftBig");
      if (big) big.textContent = `${myPoint}P`;
      if (leftBig) leftBig.textContent = `${left}P`;
    }

    function addPoint(amount) {
      myPoint = Math.min(MAX_POINT, myPoint + amount);
      uploadCount += 1;
      updateRewardUI();
      updatePassportUI();
      showToast(`+${amount}P`);
    }

    updateRewardUI();

    // ====== íŒ¨ë„ í† ê¸€ ======
    const btnUpload = document.getElementById("btnUpload");
    const btnPredict = document.getElementById("btnPredict");
    const uploadPanel = document.getElementById("uploadPanel");
    const predictPanel = document.getElementById("predictPanel");

    function togglePanel(panel) {
      if (panel === uploadPanel) predictPanel.style.display = "none";
      if (panel === predictPanel) uploadPanel.style.display = "none";
      panel.style.display = panel.style.display === "block" ? "none" : "block";
    }
    btnUpload.addEventListener("click", () => togglePanel(uploadPanel));
    btnPredict.addEventListener("click", () => togglePanel(predictPanel));

    // ====== í˜‘ì¬ ë§¤ì¹­ ======
    function normalize(s) { return (s || "").trim().replace(/\s+/g, ""); }
    function isHyeopjae(input) { return normalize(input).includes("í˜‘ì¬"); }

    function showStatus(el, message, sub) {
      el.style.display = "block";
      el.innerHTML = `${message}<small>${sub || ""}</small>`;
    }

    // ====== ì—…ë¡œë“œ: ìœ„ì¹˜ ê²€ìƒ‰ + ìƒ˜í”Œ ======
    const uploadLocInput = document.getElementById("uploadLocInput");
    const uploadLocSearch = document.getElementById("uploadLocSearch");
    const uploadLocStatus = document.getElementById("uploadLocStatus");

    const sampleWrap = document.getElementById("sampleWrap");
    const sampleImg = document.getElementById("sampleImg");
    const sampleFallback = document.getElementById("sampleFallback");
    const shotHint = document.getElementById("shotHint");

    sampleImg.onerror = () => {
      sampleFallback.style.display = "grid";
      sampleImg.style.display = "none";
    };
    sampleImg.onload = () => {
      sampleFallback.style.display = "none";
      sampleImg.style.display = "block";
    };

    uploadLocSearch.addEventListener("click", () => {
      const v = uploadLocInput.value;

      if (!v.trim()) {
        showStatus(uploadLocStatus, "âš ï¸ ìœ„ì¹˜ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.", "ì˜ˆ: í˜‘ì¬");
        sampleWrap.style.display = "none";
        shotHint.style.display = "none";
        return;
      }

      if (isHyeopjae(v)) {
        showStatus(uploadLocStatus, "âœ… ìœ„ì¹˜ í™•ì¸: í˜‘ì¬(ì‹œì•ˆ)", "ê¶Œì¥ ì´¬ì˜ ê°ë„ ìƒ˜í”Œì„ í‘œì‹œí•©ë‹ˆë‹¤.");
        sampleWrap.style.display = "block";
        shotHint.style.display = "block";
        sampleImg.src = "sample-hyeopjae.jpg";
      } else {
        showStatus(uploadLocStatus, "âš ï¸ í˜„ì¬ëŠ” â€˜í˜‘ì¬â€™ë§Œ ì‹œì•ˆ ì§€ì› ì¤‘ì…ë‹ˆë‹¤.", "í˜‘ì¬ë¡œ ì…ë ¥í•´ í…ŒìŠ¤íŠ¸í•´ ì£¼ì„¸ìš”.");
        sampleWrap.style.display = "none";
        shotHint.style.display = "none";
      }
    });

    // ====== ì—…ë¡œë“œ(ë°ëª¨) ======
    const fileInput = document.getElementById("fileInput");
    const submitUpload = document.getElementById("submitUpload");
    const uploadStatus = document.getElementById("uploadStatus");

    submitUpload.addEventListener("click", () => {
      const file = fileInput.files && fileInput.files[0];

      if (!file) {
        showStatus(uploadStatus, "âš ï¸ ì‚¬ì§„ íŒŒì¼ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.", "íŒŒì¼ ì„ íƒ í›„ ì—…ë¡œë“œ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.");
        return;
      }

      showStatus(uploadStatus, "â³ ì—…ë¡œë“œ ì¤‘...", "ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.");
      setTimeout(() => {
        addPoint(10);
        showStatus(uploadStatus, "âœ… ì—…ë¡œë“œ ì™„ë£Œ! +10P ì§€ê¸‰", "ì œë³´ê°€ ë°˜ì˜ë˜ì—ˆìŠµë‹ˆë‹¤(ë°ëª¨).");
        fileInput.value = "";
      }, 900);
    });

    // ====== ì˜ˆì¸¡(AR): ìœ„ì¹˜ ê²€ìƒ‰ í›„ ê¸°ëŠ¥ ì—´ê¸° ======
    const predictLocInput = document.getElementById("predictLocInput");
    const predictLocSearch = document.getElementById("predictLocSearch");
    const predictLocStatus = document.getElementById("predictLocStatus");

    const locLabel = document.getElementById("locLabel");
    const locName = document.getElementById("locName");

    const predictBox = document.getElementById("predictBox");
    const predictText = document.getElementById("predictText");

    const arControls = document.getElementById("arControls");
    const startARBtn = document.getElementById("startAR");
    const stopARBtn = document.getElementById("stopAR");

    const arStage = document.getElementById("arStage");
    const arVideo = document.getElementById("arVideo");
    const waterLine = document.getElementById("waterLine");
    const waterFill = document.getElementById("waterFill");
    const waterLabel = document.getElementById("waterLabel");

    // 5ë…„ 0.5m / 10ë…„ 0.7m
    const scenarios = {
      y5:  { meter: 0.5, percent: 62, text: "âœ… 5ë…„ ë’¤(í˜‘ì¬): ì¼ë¶€ êµ¬ê°„ ì¹¨ìˆ˜ ê°€ëŠ¥ì„± ì¦ê°€\nì˜ˆìƒ ìˆ˜ìœ„: 0.5m" },
      y10: { meter: 0.7, percent: 45, text: "âš ï¸ 10ë…„ ë’¤(í˜‘ì¬): ì¹¨ìˆ˜ ë²”ìœ„ í™•ëŒ€ ê°€ëŠ¥ì„±\nì˜ˆìƒ ìˆ˜ìœ„: 0.7m" }
    };

    let currentScenarioKey = "y5";
    let arStream = null;

    const p5 = document.getElementById("p5");
    const p10 = document.getElementById("p10");

    function applyScenario(key) {
      currentScenarioKey = key;
      const s = scenarios[key];

      predictText.innerHTML = s.text.replaceAll("\n", "<br/>");
      predictText.style.display = "block";

      waterLine.style.top = s.percent + "%";
      waterFill.style.top = s.percent + "%";
      waterLabel.style.top = s.percent + "%";
      waterLabel.textContent = `ì˜ˆìƒ ìˆ˜ìœ„ ${s.meter}m`;
    }

    p5.addEventListener("click", () => {
      p5.classList.add("active");
      p10.classList.remove("active");
      applyScenario("y5");
    });

    p10.addEventListener("click", () => {
      p10.classList.add("active");
      p5.classList.remove("active");
      applyScenario("y10");
    });

    function stopAR() {
      if (arStream) {
        arStream.getTracks().forEach(t => t.stop());
        arStream = null;
      }
      arStage.style.display = "none";
      stopARBtn.style.display = "none";
      startARBtn.style.display = "inline-block";
    }

    predictLocSearch.addEventListener("click", () => {
      const v = predictLocInput.value;
      if (!v.trim()) {
        showStatus(predictLocStatus, "âš ï¸ ìœ„ì¹˜ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.", "ì˜ˆ: í˜‘ì¬");
        return;
      }

      if (isHyeopjae(v)) {
        showStatus(predictLocStatus, "âœ… ìœ„ì¹˜ í™•ì¸: í˜‘ì¬(ì‹œì•ˆ)", "5ë…„/10ë…„ ë° AR ê¸°ëŠ¥ì„ í™œì„±í™”í•©ë‹ˆë‹¤.");

        locLabel.style.display = "flex";
        locName.textContent = "í˜‘ì¬";

        predictBox.style.display = "flex";
        arControls.style.display = "flex";

        p5.classList.add("active");
        p10.classList.remove("active");
        applyScenario("y5");
      } else {
        showStatus(predictLocStatus, "âš ï¸ í˜„ì¬ëŠ” â€˜í˜‘ì¬â€™ë§Œ ì‹œì•ˆ ì§€ì› ì¤‘ì…ë‹ˆë‹¤.", "í˜‘ì¬ë¡œ ì…ë ¥í•´ í…ŒìŠ¤íŠ¸í•´ ì£¼ì„¸ìš”.");

        locLabel.style.display = "none";
        predictBox.style.display = "none";
        predictText.style.display = "none";
        arControls.style.display = "none";
        stopAR();
      }
    });

    async function startAR() {
      try {
        arStream = await navigator.mediaDevices.getUserMedia({
          video: { facingMode: "environment" },
          audio: false
        });

        arVideo.srcObject = arStream;
        arStage.style.display = "block";
        stopARBtn.style.display = "inline-block";
        startARBtn.style.display = "none";

        applyScenario(currentScenarioKey);
      } catch (e) {
        alert("ì¹´ë©”ë¼ ê¶Œí•œì´ í•„ìš”í•´ìš”. ë¸Œë¼ìš°ì € ì„¤ì •ì—ì„œ ì¹´ë©”ë¼ í—ˆìš© í›„ ë‹¤ì‹œ ì‹œë„í•´ì¤˜!");
      }
    }

    startARBtn.addEventListener("click", startAR);
    stopARBtn.addEventListener("click", stopAR);
    window.addEventListener("beforeunload", () => stopAR());

    // ===================== ëª¨ë‹¬: ì—´ê¸°/ë‹«ê¸° =====================
    const rewardDockBtn = document.getElementById("rewardDockBtn");
    const rewardModal = document.getElementById("rewardModal");
    const closeReward = document.getElementById("closeReward");

    const passportHome = document.getElementById("passportHome");
    const passportModal = document.getElementById("passportModal");
    const closePassport = document.getElementById("closePassport");

    function openModal(modalEl){
      modalEl.classList.add("show");
      modalEl.setAttribute("aria-hidden","false");
      document.body.style.overflow = "hidden";
    }
    function closeModal(modalEl){
      modalEl.classList.remove("show");
      modalEl.setAttribute("aria-hidden","true");
      document.body.style.overflow = "";
    }

    rewardDockBtn.addEventListener("click", () => {
      updateRewardUI();
      openModal(rewardModal);
    });
    closeReward.addEventListener("click", () => closeModal(rewardModal));
    rewardModal.addEventListener("click", (e) => { if(e.target === rewardModal) closeModal(rewardModal); });

    passportHome.addEventListener("click", () => {
      updatePassportUI();
      openModal(passportModal);
    });
    closePassport.addEventListener("click", () => closeModal(passportModal));
    passportModal.addEventListener("click", (e) => { if(e.target === passportModal) closeModal(passportModal); });

    // ëª¨ë‹¬ì—ì„œ AR ë°”ë¡œê°€ê¸°
    document.getElementById("goARFromReward").addEventListener("click", () => {
      closeModal(rewardModal);
      // AR íŒ¨ë„ ì—´ê¸°
      if (predictPanel.style.display !== "block") {
        togglePanel(predictPanel);
      }
      // ì‚´ì§ ìŠ¤í¬ë¡¤
      setTimeout(() => {
        btnPredict.scrollIntoView({behavior:"smooth", block:"start"});
      }, 120);
    });

    // ESCë¡œ ë‹«ê¸°(PC)
    window.addEventListener("keydown", (e) => {
      if(e.key === "Escape"){
        if(rewardModal.classList.contains("show")) closeModal(rewardModal);
        if(passportModal.classList.contains("show")) closeModal(passportModal);
      }
    });

    // ===================== íŒ¨ìŠ¤í¬íŠ¸: ë ˆë²¨/í†µê³„ ê³„ì‚°(ë°ëª¨) =====================
    function getLevelInfo(count){
      // ì—…ë¡œë“œ íšŸìˆ˜ ê¸°ë°˜ ë ˆë²¨(ë°œí‘œìš© ë¡œì§)
      if(count >= 10) return { lv: 4, name: "í•´ì•ˆ ìˆ˜í˜¸ì", icon: "ğŸ›¡ï¸", need: 15, base: 10 };
      if(count >= 6)  return { lv: 3, name: "í•´ì•ˆ ê´€ì°°ì", icon: "ğŸ–ï¸", need: 10, base: 6 };
      if(count >= 3)  return { lv: 2, name: "í•´ì•ˆ íƒí—˜ê°€", icon: "ğŸ§­", need: 6,  base: 3 };
      return          { lv: 1, name: "í•´ì•ˆ ìƒˆì‹¹", icon: "ğŸŒ±", need: 3,  base: 0 };
    }

    function updatePassportUI(){
      const info = getLevelInfo(uploadCount);
      const nextNeed = Math.max(0, info.need - uploadCount);
      const denom = (info.need - info.base) || 1;
      const numer = Math.max(0, uploadCount - info.base);
      const pct = Math.min(100, Math.round((numer / denom) * 100));

      // í™ˆ ì¹´ë“œ ì„œë¸Œí…ìŠ¤íŠ¸
      const passportHomeSub = document.getElementById("passportHomeSub");
      passportHomeSub.textContent = `Lv.${info.lv} ${info.name} Â· ì¸ì¦ ${uploadCount}íšŒ`;

      // ëª¨ë‹¬ í…ìŠ¤íŠ¸
      document.querySelector("#passportModal .level-icon").textContent = info.icon;
      document.getElementById("passportLevelText").textContent = `Lv.${info.lv} ${info.name}`;
      document.getElementById("passportLevelDesc").textContent = "ê¾¸ì¤€í•œ ì°¸ì—¬ë¡œ ì•ˆì „í•œ í•´ì•ˆì„ ë§Œë“¤ì–´ê°€ê³  ìˆì–´ìš”";

      // í†µê³„(ë°œí‘œìš©: ì—…ë¡œë“œ ê¸°ë°˜ìœ¼ë¡œ ìì—°ìŠ¤ëŸ¬ìš´ ê°’ ìƒì„±)
      const visited = Math.max(1, Math.min(12, Math.floor(uploadCount / 2) + 1));
      const days = Math.max(1, 7 + uploadCount * 2);

      document.getElementById("statVisited").textContent = `${visited}ê³³`;
      document.getElementById("statUploads").textContent = `${uploadCount}íšŒ`;
      document.getElementById("statDays").textContent = `${days}ì¼`;

      document.getElementById("passportProgressFill").style.width = pct + "%";
      document.getElementById("passportProgressInfo").textContent =
        `${nextNeed}íšŒ ì°¸ì—¬ ë” í•„ìš” (${pct}% ë‹¬ì„±)`;
    }

    updatePassportUI();

    // ===================== ê´€ë¦¬ì ëª¨ë“œ (ì œëª© 3íƒ­ â†’ ì½”ë“œ 99999) =====================
const appTitle = document.getElementById("appTitle");

const adminCodeModal = document.getElementById("adminCodeModal");
const adminModal = document.getElementById("adminModal");

const closeAdminCode = document.getElementById("closeAdminCode");
const adminCodeCancel = document.getElementById("adminCodeCancel");
const adminCodeSubmit = document.getElementById("adminCodeSubmit");
const adminCodeInput = document.getElementById("adminCodeInput");
const adminCodeMsg = document.getElementById("adminCodeMsg");

const closeAdmin = document.getElementById("closeAdmin");
const adminCloseAll = document.getElementById("adminCloseAll");
const adminResetMyReward = document.getElementById("adminResetMyReward");

const adminReports = document.getElementById("adminReports");

let tapCount = 0;
let tapTimer = null;

function openModalOnly(modalEl){
  modalEl.classList.add("show");
  modalEl.setAttribute("aria-hidden","false");
  document.body.style.overflow = "hidden";
}
function closeModalOnly(modalEl){
  modalEl.classList.remove("show");
  modalEl.setAttribute("aria-hidden","true");
  document.body.style.overflow = "";
}

function openAdminCode(){
  adminCodeMsg.style.display = "none";
  adminCodeInput.value = "";
  openModalOnly(adminCodeModal);
  setTimeout(() => adminCodeInput.focus(), 60);
}

function openAdminDashboard(){
  // ê´€ë¦¬ì í™”ë©´ì— í˜„ì¬ ê°’ ë°˜ì˜(ë°ëª¨)
  // ì—…ë¡œë“œ íšŸìˆ˜ë¥¼ "ì œë³´ ê±´ìˆ˜"ì²˜ëŸ¼ ë³´ì—¬ì¤Œ
  const count = Number(localStorage.getItem("myUploadCount") || "0");
  if (adminReports) adminReports.textContent = String(count);
  openModalOnly(adminModal);
}

function closeAdminCodeModal(){ closeModalOnly(adminCodeModal); }
function closeAdminModal(){ closeModalOnly(adminModal); }

// ì œëª© 3ë²ˆ íƒ­ ê°ì§€ (ëª¨ë°”ì¼ ëŒ€ì‘: clickì´ë©´ ì¶©ë¶„)
appTitle.addEventListener("click", () => {
  tapCount += 1;

  if (tapTimer) clearTimeout(tapTimer);
  tapTimer = setTimeout(() => { tapCount = 0; }, 900); // 0.9ì´ˆ ë‚´ 3ë²ˆ

  if (tapCount >= 3) {
    tapCount = 0;
    openAdminCode();
  }
});

// ì½”ë“œ í™•ì¸
adminCodeSubmit.addEventListener("click", () => {
  const code = (adminCodeInput.value || "").trim();
  if (code === "99999") {
    closeAdminCodeModal();
    openAdminDashboard();
  } else {
    adminCodeMsg.style.display = "block";
  }
});

adminCodeInput.addEventListener("keydown", (e) => {
  if (e.key === "Enter") adminCodeSubmit.click();
});

// ë‹«ê¸°ë“¤
closeAdminCode.addEventListener("click", closeAdminCodeModal);
adminCodeCancel.addEventListener("click", closeAdminCodeModal);
adminCodeModal.addEventListener("click", (e) => { if(e.target === adminCodeModal) closeAdminCodeModal(); });

closeAdmin.addEventListener("click", closeAdminModal);
adminCloseAll.addEventListener("click", closeAdminModal);
adminModal.addEventListener("click", (e) => { if(e.target === adminModal) closeAdminModal(); });

// ê´€ë¦¬ì ê¸°ëŠ¥(ë°ëª¨): ë‚´ ë¦¬ì›Œë“œ ì´ˆê¸°í™”
adminResetMyReward.addEventListener("click", () => {
  localStorage.setItem("myPoint", "0");
  localStorage.setItem("myUploadCount", "0");

  // ë„ˆ ì½”ë“œì— ì´ë¯¸ ìˆëŠ” ì—…ë°ì´íŠ¸ í•¨ìˆ˜ê°€ ìˆìœ¼ë©´ ê·¸ëŒ€ë¡œ í˜¸ì¶œë¨
  if (typeof updateRewardUI === "function") updateRewardUI();
  if (typeof updatePassportUI === "function") updatePassportUI();

  alert("ë‚´ ë¦¬ì›Œë“œê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤ (ë°ëª¨).");
  // ê´€ë¦¬ì í™”ë©´ ìˆ«ìë„ ê°±ì‹ 
  if (adminReports) adminReports.textContent = "0";
});

  </script>
</body>
</html>
